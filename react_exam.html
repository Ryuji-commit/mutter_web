<!DOCTYPE html>
<html>
  <head>
    <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.min.js"></script>
    <link rel="stylesheet" href="css/react_exam_style.css">
  </head>
  <body>
    <div id="row1"></div>

    <script type="text/babel">

      class Square extends React.Component {
        constructor(props) {
          super(props);
          this.state = {
            isactive: false,
          }
          this.changeActive = this.changeActive.bind(this);
        }

        changeActive() {
          this.setState({
            isactive: !this.state.isactive,
          });
        }
        
        render() {
          return(
            <button className="square" onClick={this.changeActive} isactive={this.state.isactive.toString()}></button>
          );
        }
      }

      class PixelArt extends React.Component {
        constructor(props) {
          super(props);
          this.state = { 
            squares: 5, 
            temp: 5,
          };
          this.handleChange = this.handleChange.bind(this);
          this.handleSubmit = this.handleSubmit.bind(this);
        }

        render() {
          return(
            <div className="board">
              <form onSubmit={this.handleSubmit}>
                <label>幅 : </label>
                <input type="number" name="squares" value={this.state.temp} min="5" max="20" 
                  onChange={this.handleChange}/>
                <button className="submit-button">決定</button>
              </form>
            {
              Array(this.state.squares).fill(0).map((val, i) => {
                return (
                  <div className="board-row">
                  {
                    Array(this.state.squares).fill(0).map((val2, j) => {
                      return(
                        <Square key={String(i) + String(j)}/>
                      )
                    })
                  }
                  </div>
                );
              })
            }  
            </div>
          );
        }

        handleChange(e) {
          this.setState({temp: e.target.value});
        }

        handleSubmit(e) {
          e.preventDefault();
          let inputval;
          if (!this.state.temp) {
            inputval = 5;
          }else {
            inputval = parseInt(this.state.temp);
          }

          if (inputval < 5) {
            inputval = 5;
          }

          if (inputval > 20) {
            inputval = 20;
          }
          this.setState({squares: inputval});
        }
      }

      ReactDOM.render(
        <PixelArt />,
        document.getElementById('row1')
      );

    </script>

  </body>
</html>